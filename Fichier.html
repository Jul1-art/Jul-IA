<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Retro File Explorer ++</title>
  <style>
    body {
      margin: 0;
      background: #000;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      overflow: hidden;
    }

    #terminal {
      padding: 20px;
      height: 100vh;
      overflow-y: auto;
      position: relative;
      z-index: 1;
      text-shadow: 0 0 3px #00ff00;
      border-left: 2px solid #0f0;
      box-shadow: inset 0 0 10px #0f0;
    }

    input[type="file"],
    #commandInput {
      margin-bottom: 20px;
      background: transparent;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 6px 10px;
      font-family: inherit;
      width: 100%;
    }

    #fileList li {
      cursor: pointer;
      padding: 4px;
      transition: background 0.2s;
      position: relative;
    }

    #fileList li:hover {
      background: rgba(0, 255, 0, 0.2);
    }

    pre {
      white-space: pre-wrap;
      background: rgba(0, 255, 0, 0.05);
      padding: 10px;
      margin-top: 10px;
      max-height: 400px;
      overflow-y: auto;
      border-left: 2px solid #0f0;
    }

    canvas#stars {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 0;
    }

    /* Fen√™tre de mot de passe */
    #passwordModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0,0,0,0.95);
      color: #0f0;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      font-size: 18px;
    }

    #passwordModal input {
      margin-top: 10px;
      padding: 10px;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
    }

    #passwordModal button {
      margin-top: 10px;
      padding: 8px 16px;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      cursor: pointer;
    }

    #closeModal {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
      color: #0f0;
    }
  </style>
</head>
<body>
<canvas id="stars"></canvas>
<div id="terminal">
  <h1>üß™ Retro File Explorer ++</h1>
  <input type="file" id="folderInput" webkitdirectory multiple />
  <ul id="fileList"></ul>
  <pre id="filePreview"></pre>
  <input type="text" id="commandInput" placeholder="> tape une commande..." autofocus />
  <pre id="commandOutput"></pre>
</div>

<!-- Fen√™tre de mot de passe -->
<div id="passwordModal">
  <div id="closeModal">‚úñ</div>
  <div>üîê Acc√®s restreint - Veuillez entrer votre mot de passe :</div>
  <input type="password" id="passwordInput" placeholder="Mot de passe..." />
  <button onclick="validatePassword()">Valider</button>
</div>

<script>
const canvas = document.getElementById('stars');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let stars = Array.from({length: 150}, () => ({
  x: Math.random() * canvas.width,
  y: Math.random() * canvas.height,
  size: Math.random() * 2,
  speed: Math.random() * 0.5 + 0.2
}));

function animateStars() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#0f0';
  stars.forEach(s => {
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
    ctx.fill();
    s.y += s.speed;
    if (s.y > canvas.height) {
      s.y = 0;
      s.x = Math.random() * canvas.width;
    }
  });
  requestAnimationFrame(animateStars);
}
animateStars();

const folderInput = document.getElementById('folderInput');
const fileList = document.getElementById('fileList');
const filePreview = document.getElementById('filePreview');
const commandInput = document.getElementById('commandInput');
const commandOutput = document.getElementById('commandOutput');

folderInput.addEventListener('change', async (event) => {
  const files = Array.from(event.target.files);
  fileList.innerHTML = '';
  filePreview.textContent = '';
  commandOutput.textContent = '';

  files.forEach(file => {
    const li = document.createElement('li');
    li.textContent = file.webkitRelativePath;
    li.addEventListener('click', () => previewFile(file));
    fileList.appendChild(li);
  });

  // Affiche le mot de passe apr√®s 1.5s
  setTimeout(() => {
    document.getElementById('passwordModal').style.display = 'flex';
  }, 1500);
});

function previewFile(file) {
  filePreview.textContent = 'üì§ Chargement du fichier';
  let dots = 0;
  const interval = setInterval(() => {
    filePreview.textContent = 'üì§ Chargement du fichier' + '.'.repeat(dots % 4);
    dots++;
  }, 300);

  const reader = new FileReader();
  reader.onload = () => {
    clearInterval(interval);
    if (file.type.startsWith('image')) {
      filePreview.textContent = '[üñºÔ∏è Image non affichable en ASCII]';
    } else if (file.type === 'text/plain' || file.type === '') {
      filePreview.textContent = reader.result.slice(0, 1000);
    } else {
      filePreview.textContent = '[üõë Type de fichier non pris en charge]';
    }
  };
  reader.readAsText(file);
}

commandInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    const cmd = commandInput.value.trim();
    processCommand(cmd);
    commandInput.value = '';
  }
});

function processCommand(cmd) {
  if (cmd === 'help') {
    commandOutput.textContent = `Commandes disponibles :
- help : liste les commandes
- clear : nettoie la console
- open [nom] : tente d‚Äôouvrir un fichier
- credits : affiche les cr√©dits
`;
  } else if (cmd.startsWith('open ')) {
    const target = cmd.slice(5);
    const file = Array.from(folderInput.files).find(f => f.name === target);
    if (file) previewFile(file);
    else commandOutput.textContent = `üö´ Fichier "${target}" introuvable.`;
  } else if (cmd === 'clear') {
    commandOutput.textContent = '';
    filePreview.textContent = '';
  } else if (cmd === 'credits') {
    commandOutput.textContent = `üîß HackFichier by Ferrier \nRetro vibes powered by Jul-IA`;
  } else {
    commandOutput.textContent = `‚ùì Commande inconnue : ${cmd}\nTape "help" pour voir les options.`;
  }
}

// Gestion de la fen√™tre de mot de passe
function validatePassword() {
  window.location.href = 'hack.html'; // vers la page de simulation du hack
}
document.getElementById('closeModal').onclick = () => {
  document.getElementById('passwordModal').style.display = 'none';
};
</script>
</body>
</html>
